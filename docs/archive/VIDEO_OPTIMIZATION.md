# Video Optimization Guide

## üìπ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤–∏–¥–µ–æ –¥–ª—è MovieNightPicker

–≠—Ç–æ—Ç –≥–∞–π–¥ –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–∏–¥–µ–æ —Ñ–∞–π–ª—ã –¥–ª—è –≤–µ–±-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–º–µ–Ω—å—à–∏–≤ –∏—Ö —Ä–∞–∑–º–µ—Ä –±–µ–∑ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –ø–æ—Ç–µ—Ä–∏ –∫–∞—á–µ—Å—Ç–≤–∞.

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

| –í–µ—Ä—Å–∏—è | –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ | –†–∞–∑–º–µ—Ä | –£–º–µ–Ω—å—à–µ–Ω–∏–µ |
|--------|------------|--------|------------|
| –û—Ä–∏–≥–∏–Ω–∞–ª | 3152x2160 | 33MB | - |
| –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è | 1920x1080 | 1.3MB | 96% |
| –ú–æ–±–∏–ª—å–Ω–∞—è | 1280x720 | 477KB | 98.5% |
| –ü–æ—Å—Ç–µ—Ä | 1920x1080 | 87KB | - |

## üõ†Ô∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞

```bash
# –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–∏–¥–µ–æ —Ñ–∞–π–ª
./scripts/optimize-video.sh public/your_video.mp4
```

–°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞—Å—Ç:
- `your_video_optimized.mp4` - –≤–µ—Ä—Å–∏—è –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞ (1080p)
- `your_video_mobile.mp4` - –≤–µ—Ä—Å–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö (720p)
- `your_video_poster.jpg` - –ø–æ—Å—Ç–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **ffmpeg** –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:
  ```bash
  brew install ffmpeg
  ```

## üîß –†—É—á–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

### –î–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞ (1080p)
```bash
ffmpeg -i input.mp4 \
  -vf "scale=1920:1080:force_original_aspect_ratio=decrease,pad=1920:1080:(ow-iw)/2:(oh-ih)/2" \
  -c:v libx264 \
  -preset medium \
  -crf 28 \
  -c:a aac \
  -b:a 128k \
  -movflags +faststart \
  output_optimized.mp4
```

### –î–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö (720p)
```bash
ffmpeg -i input.mp4 \
  -vf "scale=1280:720:force_original_aspect_ratio=decrease,pad=1280:720:(ow-iw)/2:(oh-ih)/2" \
  -c:v libx264 \
  -preset medium \
  -crf 32 \
  -c:a aac \
  -b:a 96k \
  -movflags +faststart \
  output_mobile.mp4
```

### –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–µ—Ä–∞
```bash
ffmpeg -i optimized_video.mp4 \
  -ss 00:00:02 \
  -vframes 1 \
  -q:v 2 \
  poster.jpg
```

## üì± –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –≤–∏–¥–µ–æ –≤ –∫–æ–¥–µ

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç `VideoAd` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â—É—é –≤–µ—Ä—Å–∏—é:

```typescript
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –≤–µ—Ä—Å–∏–∏
const videoSource = isMobile ? '/ad_preview_mobile.mp4' : '/ad_preview_optimized.mp4';

// –í JSX
<video
  src={videoSource}
  poster="/ad_preview_poster.jpg"
  autoPlay
  muted
  loop
  playsInline
  preload="auto"
/>
```

## ‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### CRF (Constant Rate Factor)
- **CRF 18-23**: –û—á–µ–Ω—å –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ (–±–æ–ª—å—à–æ–π —Ä–∞–∑–º–µ—Ä)
- **CRF 24-28**: –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞)
- **CRF 29-32**: –°—Ä–µ–¥–Ω–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö)
- **CRF 33-40**: –ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ (–æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏–π —Ä–∞–∑–º–µ—Ä)

### Preset
- **ultrafast**: –ë—ã—Å—Ç—Ä–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ, –±–æ–ª—å—à–∏–π —Ä–∞–∑–º–µ—Ä
- **medium**: –ë–∞–ª–∞–Ω—Å —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ —Ä–∞–∑–º–µ—Ä–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- **slow**: –ú–µ–¥–ª–µ–Ω–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ, –º–µ–Ω—å—à–∏–π —Ä–∞–∑–º–µ—Ä

### Audio Bitrate
- **128k**: –•–æ—Ä–æ—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞
- **96k**: –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
- **64k**: –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ

## üöÄ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –≤–µ–±–∞

### –í–∞–∂–Ω—ã–µ —Ñ–ª–∞–≥–∏
- `-movflags +faststart`: –ü–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—á–∞—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –¥–æ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
- `playsInline`: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –Ω–∞ iOS
- `preload="auto"`: –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤–∏–¥–µ–æ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
1. **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ** `faststart` –¥–ª—è –≤–µ–±-–≤–∏–¥–µ–æ
2. **–î–æ–±–∞–≤–ª—è–π—Ç–µ –ø–æ—Å—Ç–µ—Ä** –¥–ª—è –ª—É—á—à–µ–≥–æ UX
3. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö** —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –≤–µ—Ä—Å–∏–∏** –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤
```bash
ls -lh public/ad_preview*.mp4 public/ad_preview*.jpg
```

### –ê–Ω–∞–ª–∏–∑ –≤–∏–¥–µ–æ
```bash
ffprobe -v quiet -print_format json -show_format -show_streams video.mp4
```

## üîç Troubleshooting

### –í–∏–¥–µ–æ –Ω–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –ø–∞–ø–∫–µ `public/`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –æ—à–∏–±–∫–∏

### –ë–æ–ª—å—à–æ–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞
1. –£–≤–µ–ª–∏—á—å—Ç–µ CRF (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å 28 –¥–æ 32)
2. –£–º–µ–Ω—å—à–∏—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ
3. –°–Ω–∏–∑—å—Ç–µ –±–∏—Ç—Ä–µ–π—Ç –∞—É–¥–∏–æ

### –ü–ª–æ—Ö–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
1. –£–º–µ–Ω—å—à–∏—Ç–µ CRF (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å 32 –¥–æ 28)
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ preset `slow` –≤–º–µ—Å—Ç–æ `medium`
3. –£–≤–µ–ª–∏—á—å—Ç–µ –±–∏—Ç—Ä–µ–π—Ç –∞—É–¥–∏–æ

## üìù –ó–∞–º–µ—Ç–∫–∏

- –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ö—Ä–∞–Ω–∏—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –≤ git
- –î–ª—è production –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ CDN –¥–ª—è –≤–∏–¥–µ–æ —Ñ–∞–π–ª–æ–≤ 